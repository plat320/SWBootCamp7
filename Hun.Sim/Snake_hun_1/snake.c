#include "snake.h"
#include "lcd.h"
//#include <stdio.h>
//#include <conio.h> // Windows에서 getch() 함수를 사용하기 위한 헤더
//#include <stdlib.h>
//#include <time.h>

// 화면 크기 설정
#define WIDTH 240
#define HEIGHT 240
#define CELL_SIZE 20

// 뱀의 최대 길이 설정
#define MAX_LENGTH (WIDTH / CELL_SIZE -2) * (HEIGHT / CELL_SIZE -2)

unsigned short apple_img[400] = {
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x10A0, 0x10A0,
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
0x29A2, 0x63C6, 0x9D87, 0x1080, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
0x2081, 0x5142, 0x0000, 0x5BE5, 0xA6C9, 0xBF8A, 0x4B04, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x48E2, 0x4223, 0x6628, 0x65C7, 0x2AE3, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
0x0000, 0x0000, 0x0000, 0x0000, 0x2041, 0x79A7, 0xA1E8, 0x9166, 0x58C3, 0x2021, 0x4A83, 0x5BA5, 0x79E4, 0x68A4, 0x4082, 0x0000,
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x3882, 0xF38F, 0xFCB3, 0xFBAF, 0xFAEC, 0xFA6A, 0xE1C8, 0xC986, 0xE147,
0xF988, 0xF9C9, 0xF167, 0xA8E5, 0x1020, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0800, 0xDA8B, 0xFC72, 0xF36E, 0xF2AB, 0xF2AB,
0xF26B, 0xF22A, 0xF1E9, 0xF1C8, 0xE9A8, 0xE167, 0xD926, 0xE926, 0x98A4, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x40A2, 0xFB6E,
0xF36E, 0xF26A, 0xF229, 0xF209, 0xF1E9, 0xF1E9, 0xE9C8, 0xE9A8, 0xE987, 0xE947, 0xD905, 0xD0E5, 0xD0A4, 0x2020, 0x0000, 0x0000,
0x0000, 0x0000, 0x7125, 0xFB6E, 0xF2EC, 0xF22A, 0xF209, 0xF1E9, 0xF1C9, 0xF1A8, 0xE988, 0xE967, 0xE967, 0xE947, 0xD8E5, 0xC8A4,
0xC883, 0x4821, 0x0000, 0x0000, 0x0000, 0x0000, 0x8966, 0xFB2D, 0xF28B, 0xF209, 0xF1E9, 0xF1C8, 0xF1A8, 0xE988, 0xE967, 0xE947,
0xE926, 0xE926, 0xD8E5, 0xC083, 0xC863, 0x4821, 0x0000, 0x0000, 0x0000, 0x0000, 0x8125, 0xFACC, 0xF24A, 0xF1E9, 0xF1C8, 0xE9A8,
0xE988, 0xE967, 0xE947, 0xE926, 0xE906, 0xE8E6, 0xE0C5, 0xB862, 0xC042, 0x3800, 0x0000, 0x0000, 0x0000, 0x0000, 0x50A3, 0xFA4A,
0xEA09, 0xF1C8, 0xF1A8, 0xE988, 0xE967, 0xE947, 0xE927, 0xE906, 0xE8E6, 0xE0C5, 0xC883, 0xB842, 0xA821, 0x1000, 0x0000, 0x0000,
0x0000, 0x0000, 0x1020, 0xE1C8, 0xF1C8, 0xE9A8, 0xE167, 0xE146, 0xE126, 0xE106, 0xE0E5, 0xD8C5, 0xD0A4, 0xC863, 0xB842, 0xB821,
0x8021, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x80E4, 0xF9A8, 0xD946, 0xD926, 0xD905, 0xD0E5, 0xD0C4, 0xC8A4, 0xC883,
0xC063, 0xC042, 0xB021, 0xB021, 0x3800, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0800, 0xC926, 0xE126, 0xD105, 0xD0E5,
0xD0C4, 0xC8A4, 0xC883, 0xC063, 0xC042, 0xB022, 0xB001, 0x8801, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
0x4061, 0xE906, 0xD0E5, 0xC8C4, 0xC8A4, 0xD083, 0xC863, 0xC042, 0xB021, 0xA801, 0xA801, 0x2000, 0x0000, 0x0000, 0x0000, 0x0000,
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x7082, 0xD0C4, 0xD0A4, 0xC883, 0xA042, 0x9842, 0xB021, 0xB001, 0xA001, 0x3000, 0x0000,
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x2020, 0x3821, 0x2000, 0x0000, 0x0000, 0x2800,
0x4000, 0x1000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000
};

unsigned short grass_img[400] = {
0x84E5, 0x84A6, 0x9545, 0x8D05, 0x8D25, 0x8504, 0x84C5, 0x84E5, 0x8CE5, 0x84C6, 0x84E5, 0x8505, 0x84E5, 0x84E5, 0x8504, 0x8505,
0x8D45, 0x7D04, 0x7CC4, 0x8525, 0x84E5, 0x84E5, 0x8D25, 0x84E4, 0x84E5, 0x84E5, 0x8D05, 0x84E5, 0x7CE5, 0x7CE5, 0x8505, 0x8526,
0x7CE6, 0x7CC5, 0x84E5, 0x84E5, 0x8505, 0x8545, 0x8505, 0x7CE4, 0x84E5, 0x8524, 0x8504, 0x84A5, 0x84A5, 0x84E5, 0x8D25, 0x8505,
0x7CC5, 0x7CE5, 0x84E5, 0x7CC5, 0x74C5, 0x74A5, 0x7D05, 0x8505, 0x7CE5, 0x8506, 0x8D25, 0x8D05, 0x7CC5, 0x7CE4, 0x8505, 0x84C5,
0x84E5, 0x8505, 0x8505, 0x8505, 0x7CC5, 0x7CC6, 0x8506, 0x8506, 0x8506, 0x7D05, 0x7CE5, 0x7CE5, 0x8525, 0x8505, 0x8D05, 0x84E5,
0x7CE5, 0x7CE4, 0x84C5, 0x7CC4, 0x7D05, 0x7CE4, 0x7CC5, 0x8D25, 0x7D05, 0x7CC6, 0x7CE5, 0x8526, 0x8D66, 0x7CE5, 0x8505, 0x8525,
0x8505, 0x7CE4, 0x7CC5, 0x7CC5, 0x8D05, 0x8D05, 0x8525, 0x84E4, 0x84E5, 0x7CE5, 0x74A4, 0x7CC5, 0x8525, 0x8525, 0x7D05, 0x7CC5,
0x8D06, 0x8505, 0x8545, 0x7D24, 0x7CE5, 0x7CE5, 0x8505, 0x7CC5, 0x8505, 0x84E5, 0x7484, 0x9546, 0x84E4, 0x8505, 0x7CE5, 0x8D25,
0x8544, 0x7D04, 0x8525, 0x8525, 0x84E5, 0x8525, 0x8545, 0x7D44, 0x74C5, 0x8505, 0x7CE4, 0x84E5, 0x84E5, 0x84E5, 0x7CC6, 0x8D05,
0x8505, 0x8D45, 0x8525, 0x8505, 0x8524, 0x7D24, 0x8D45, 0x8D25, 0x8525, 0x8D45, 0x84E5, 0x8505, 0x7CE5, 0x7CE5, 0x7CE4, 0x7CE4,
0x84E4, 0x7CC4, 0x7CC5, 0x8D05, 0x8D05, 0x84E4, 0x8525, 0x7CE4, 0x7CC4, 0x8525, 0x8525, 0x8D45, 0x7D24, 0x8D45, 0x84E5, 0x8D26,
0x8525, 0x8526, 0x84E5, 0x7CA5, 0x84E5, 0x8504, 0x7CC5, 0x7CE5, 0x8D65, 0x7D04, 0x8525, 0x8D45, 0x7CC5, 0x7D05, 0x8504, 0x8D25,
0x84E5, 0x8505, 0x9565, 0x8505, 0x8D25, 0x8D45, 0x8D05, 0x84C5, 0x84E5, 0x8504, 0x84E4, 0x84E5, 0x8504, 0x8505, 0x8D45, 0x7D04,
0x7CC4, 0x8505, 0x84E5, 0x84C6, 0x9545, 0x8D05, 0x8D25, 0x8524, 0x84C5, 0x8504, 0x8D05, 0x84E6, 0x84E5, 0x84E4, 0x7CE4, 0x7CA5,
0x84C5, 0x8D05, 0x8505, 0x8D45, 0x8505, 0x7CE4, 0x84E5, 0x84E5, 0x8D25, 0x8504, 0x8505, 0x8505, 0x8D05, 0x84C5, 0x84E4, 0x84E5,
0x7CE5, 0x7CC5, 0x8525, 0x7CA4, 0x7CE5, 0x8525, 0x8505, 0x8505, 0x8D25, 0x8D05, 0x84E5, 0x8524, 0x8504, 0x7CE5, 0x8D25, 0x84E5,
0x7CC5, 0x84E5, 0x7CC5, 0x84E5, 0x8506, 0x7CE5, 0x7CA4, 0x7D04, 0x8505, 0x84E5, 0x84E5, 0x8D26, 0x8D25, 0x8505, 0x7CC5, 0x84E4,
0x8525, 0x7CC4, 0x8505, 0x8525, 0x8505, 0x84E5, 0x7CE5, 0x84E6, 0x7CE5, 0x84E5, 0x7CE4, 0x7CA5, 0x7CC5, 0x74A4, 0x7CE4, 0x8504,
0x7CC5, 0x7CC5, 0x7CE5, 0x7CE4, 0x8505, 0x7D04, 0x8505, 0x8D25, 0x8525, 0x7D05, 0x7D05, 0x7CC6, 0x7D05, 0x7CC5, 0x74A4, 0x74A4,
0x74C4, 0x74A4, 0x7CE4, 0x8505, 0x7CC4, 0x7CC5, 0x8D06, 0x8505, 0x84E5, 0x8D24, 0x8D25, 0x84E5, 0x8505, 0x7CC5, 0x8525, 0x8545,
0x8525, 0x8525, 0x8505, 0x74C4, 0x7483, 0x7CC4, 0x7CE4, 0x7CE5, 0x74A5, 0x84E5, 0x8525, 0x84E5, 0x84E5, 0x8D25, 0x8524, 0x7CC4,
0x7CC5, 0x7CE5, 0x8524, 0x7D04, 0x8D45, 0x8525, 0x8525, 0x8505, 0x7CE4, 0x7CC4, 0x8504, 0x7CC4, 0x7CC5, 0x7CC5, 0x8505, 0x8504,
0x7CC4, 0x7CE4, 0x8505, 0x7CC5, 0x7CC5, 0x7CC5, 0x7D05, 0x7D24, 0x8525, 0x8D45, 0x7D24, 0x8524, 0x8505, 0x84E5, 0x7CC4, 0x8505,
0x84C5, 0x7CA5, 0x8504, 0x7CE4, 0x7CE4, 0x84E4, 0x8505, 0x8505, 0x8D46, 0x7CE4, 0x7CC5, 0x8525, 0x8504, 0x8D25, 0x84E5, 0x84E5,
0x9565, 0x8505, 0x8D25, 0x8D45, 0x84E5, 0x7CA5, 0x84E4, 0x84E4, 0x74A4, 0x7CC4, 0x8D45, 0x7D04, 0x8525, 0x8D45, 0x7CC4, 0x8505
};

unsigned short black_img[400] = {
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000
};

unsigned short snake_head_img[400] = {
0x2945, 0x2124, 0x2144, 0x1904, 0x2904, 0x29A6, 0x2145, 0x18E3, 0x2104, 0x2945, 0x2124, 0x2124, 0x2945, 0x2124, 0x2124, 0x2124,
0x2124, 0x2945, 0x2124, 0x2945, 0x2945, 0x18C3, 0x2103, 0x38E4, 0x2C4B, 0x3671, 0x3DAF, 0x542E, 0x21A5, 0x1062, 0x18E3, 0x18C3,
0x18C3, 0x18C3, 0x10A2, 0x10A2, 0x18C3, 0x18C3, 0x18C3, 0x2124, 0x2924, 0x10C3, 0x5186, 0xCA49, 0x9610, 0x3F32, 0x3712, 0x8737,
0x4651, 0x1964, 0x18C3, 0x18E3, 0x18E3, 0x18C3, 0x18C3, 0x18C3, 0x18C3, 0x18E3, 0x18C3, 0x2124, 0x2945, 0x18C3, 0x18E3, 0x10A3,
0xC52E, 0xE774, 0x5F33, 0x2ED1, 0x3773, 0x346C, 0x1862, 0x18E3, 0x18C3, 0x18C3, 0x18E3, 0x18E3, 0x18C3, 0x18C3, 0x18C3, 0x2124,
0x2945, 0x18C3, 0x10C2, 0x18C3, 0x2124, 0x7B6A, 0xB54E, 0xBE92, 0x6F33, 0x2DCF, 0x18C3, 0x18C3, 0x18C3, 0x18C3, 0x18E3, 0x18E3,
0x18E3, 0x10A2, 0x18C3, 0x2945, 0x2945, 0x18C3, 0x18C3, 0x18C3, 0x18C3, 0x0862, 0x0862, 0x5206, 0xD692, 0x4712, 0x2226, 0x1882,
0x18E3, 0x18C3, 0x18C3, 0x18E3, 0x18C3, 0x18C3, 0x18C3, 0x2124, 0x2124, 0x18C3, 0x18E3, 0x18C3, 0x18C2, 0x18E3, 0x18E3, 0x18E3,
0xDE11, 0x6773, 0x2349, 0x1862, 0x18E3, 0x18E3, 0x18C3, 0x10A2, 0x18C3, 0x18E3, 0x18C3, 0x2124, 0x2945, 0x18E3, 0x18E3, 0x18C3,
0x18C3, 0x18E3, 0x1082, 0x41E5, 0xEED2, 0x4F53, 0x22C8, 0x1862, 0x18E3, 0x18E3, 0x18C3, 0x18C3, 0x18C3, 0x18E3, 0x18C3, 0x2945,
0x2124, 0x18C3, 0x18C3, 0x18C3, 0x18E3, 0x18E3, 0x08A2, 0xBC6B, 0xAF53, 0x2E50, 0x2124, 0x18C3, 0x18E3, 0x18E3, 0x18C3, 0x18E3,
0x18C3, 0x18C3, 0x18C3, 0x2945, 0x2945, 0x10A2, 0x18C3, 0x18E3, 0x18E3, 0x1082, 0x4164, 0xEE90, 0x4F33, 0x352E, 0x1944, 0x18A3,
0x1042, 0x1862, 0x18E3, 0x18E3, 0x18E3, 0x18E3, 0x18C3, 0x2945, 0x2124, 0x18C3, 0x18C3, 0x18E3, 0x18C3, 0x0904, 0x7CAB, 0xC6D1,
0x4F14, 0x4691, 0x2DEE, 0x2C6B, 0x2328, 0x2267, 0x18C3, 0x18C3, 0x18E3, 0x18C3, 0x18C3, 0x2124, 0x2945, 0x18E3, 0x18E3, 0x10C3,
0x20E3, 0x45AF, 0x6F11, 0xD670, 0x4F14, 0x5ED3, 0x3670, 0x36B1, 0x3F12, 0x4773, 0x2B8A, 0x1882, 0x18E3, 0x2165, 0x18E3, 0x2124,
0x2124, 0x18C3, 0x2103, 0x0862, 0x6A26, 0x8753, 0x2691, 0xAE4F, 0x6ED2, 0x4713, 0x4F13, 0x3EF2, 0x3ED2, 0x3F12, 0x2D6E, 0x1021,
0x21C5, 0x4B49, 0x1082, 0x2124, 0x2945, 0x18C3, 0x18C3, 0x08E3, 0x64CC, 0xDED0, 0x36F2, 0x2EB1, 0x4E90, 0x36B1, 0x36B1, 0x36B1,
0x2E91, 0x3F12, 0x54CD, 0x1185, 0x658F, 0x39C5, 0x1082, 0x2945, 0x2945, 0x18C3, 0x1862, 0x54CD, 0x4F95, 0xA64E, 0xDEB1, 0x7EF3,
0x46F2, 0x3ED2, 0x3ED2, 0x46D2, 0x6EF2, 0x86D2, 0x3DCE, 0x6ED2, 0x6B6A, 0x0841, 0x18C3, 0x2945, 0x2945, 0x10A3, 0x2903, 0xCE50,
0x6735, 0x2ED2, 0x764F, 0xC670, 0xD6B1, 0xCEB2, 0xC6B2, 0xAEB1, 0x7E70, 0x35EE, 0x2E90, 0x5BCA, 0x1042, 0x18E3, 0x18C3, 0x2124,
0x2124, 0x18E3, 0x10A3, 0xAC4A, 0xE753, 0x66F3, 0x26D2, 0x1EB1, 0x3E90, 0x4E90, 0x4690, 0x2E90, 0x2690, 0x36F2, 0x3630, 0x1103,
0x18C3, 0x18E3, 0x18C3, 0x2124, 0x2945, 0x18E3, 0x18C3, 0x18E3, 0xAC6B, 0xFF12, 0xD733, 0x8F33, 0x5F13, 0x4713, 0x4733, 0x5753,
0x6773, 0x5671, 0x2287, 0x1882, 0x18E3, 0x18E3, 0x18C3, 0x2124, 0x2124, 0x18C3, 0x18E3, 0x10A3, 0x0882, 0x5A66, 0xAC6B, 0xDDAE,
0xE610, 0xD610, 0xB5B0, 0x94AD, 0x6329, 0x2103, 0x1882, 0x18C3, 0x18C3, 0x18E3, 0x18C3, 0x2124, 0x3186, 0x2124, 0x2124, 0x2945,
0x2965, 0x1904, 0x18E4, 0x2124, 0x3185, 0x3985, 0x2945, 0x20E4, 0x18C3, 0x2124, 0x2965, 0x2945, 0x2945, 0x2124, 0x2124, 0x3186
};

//unsigned short Rotated_head_img[CELL_SIZE*CELL_SIZE];
// 게임 상태 변수
int game_over;
int eaten;
int score;
// 뱀의 좌표 구조체

struct Snake {
struct array {
    int x, y;
} body[MAX_LENGTH];

int tail_x;
int tail_y;

} snake;

// 먹이의 좌표 구조체
struct Food {
    int x, y;
} food;

// 방향 상수 정의
enum Direction { STOP = 0, LEFT, RIGHT, UP, DOWN };
enum Direction dir;

// 화면 초기 설정
void setup() {
    game_over = 0;
    eaten = 1;
    score = 0;
    dir = STOP;

    // 뱀의 초기 위치 설정
    snake.body[0].x = WIDTH / (2*CELL_SIZE);
    snake.body[0].y = HEIGHT /(2*CELL_SIZE);
    snake.tail_x = WIDTH / (2*CELL_SIZE);
    snake.tail_y = HEIGHT /(2*CELL_SIZE);

    // 초기 먹이 위치 설정
    srand(0);//time(NULL));
    food.x = 6;//rand() % (WIDTH / CELL_SIZE);
    food.y = 3;//rand() % (HEIGHT / CELL_SIZE);
}

void draw_init() {

	int i,j,k;
	// 정사각형이 아니라면 이 부분 수정 필요 (GAME_WINDOW_ROW != GAME_WINDOW_COLUMN 인 경우)

	//draw border  테두리 그리기
	for (i = 0; i < GAME_WINDOW_ROW; i++)
	{
		Lcd_Draw_Box(i * OBJECT_BLOCK_SIZE, 0, OBJECT_BLOCK_SIZE, OBJECT_BLOCK_SIZE, 0xffff);
		Lcd_Draw_Box(0, i * OBJECT_BLOCK_SIZE, OBJECT_BLOCK_SIZE, OBJECT_BLOCK_SIZE, 0xffff);
		Lcd_Draw_Box(i * OBJECT_BLOCK_SIZE, (GAME_WINDOW_ROW - 1) * OBJECT_BLOCK_SIZE, OBJECT_BLOCK_SIZE, OBJECT_BLOCK_SIZE, 0xffff);
		Lcd_Draw_Box((GAME_WINDOW_ROW - 1) * OBJECT_BLOCK_SIZE, i * OBJECT_BLOCK_SIZE, OBJECT_BLOCK_SIZE, OBJECT_BLOCK_SIZE, 0xffff);
	}

    for ( i = 1; i < HEIGHT / CELL_SIZE -1; i++) {

        for (j = 1; j < WIDTH / CELL_SIZE -1; j++) {

            int is_snake_body = 0;
            int is_apple = 0;

								// snake 몸 그리기 , score ; 길이
                if (snake.body[0].x == j && snake.body[0].y == i) {

                	Lcd_Draw_IMG(j*CELL_SIZE, i*CELL_SIZE,  20,  20,  &snake_head_img);
                    is_snake_body = 1;
                }


            if (!is_snake_body && food.x == j && food.y == i) {				// 사과 그리기
            	Lcd_Draw_IMG(j*CELL_SIZE, i*CELL_SIZE,  20,  20,  &apple_img);
            	is_apple = 1;

            }

            if(is_apple ==0 && is_snake_body ==0)
            	Lcd_Draw_IMG(j*CELL_SIZE, i*CELL_SIZE,  20,  20,  &grass_img);
        }

    }


}

// 화면 출력
void draw() {

	int i,j,k;


	if(eaten)
	Lcd_Draw_IMG(snake.tail_x*CELL_SIZE, snake.tail_y*CELL_SIZE,  20,  20,  &black_img);	// 움직인 후 사과 먹을 때 뱀 꼬리 그리기
	else
	Lcd_Draw_IMG(snake.tail_x*CELL_SIZE, snake.tail_y*CELL_SIZE,  20,  20,  &grass_img);	// 움직인 후 사과 안 먹고  잔디 채우기
	Lcd_Draw_IMG(food.x*CELL_SIZE, food.y*CELL_SIZE,  20,  20,  &apple_img);		// 사과 그리기
	rotate_image_array(snake_head_img, UP);
	Lcd_Draw_IMG(snake.body[0].x*CELL_SIZE, snake.body[0].y*CELL_SIZE,  20,  20,  &snake_head_img);		// 뱀 머리 그리기

    for (k = 1; k < score+1; k++) {								// snake 몸 그리기 , score ; 길이
    Lcd_Draw_IMG(snake.body[k].x*CELL_SIZE, snake.body[k].y*CELL_SIZE,  20,  20,  &black_img);
    }


/*
 *
    for (i=1; i < HEIGHT / CELL_SIZE-1; i++) {

        for (j = 1; j < WIDTH / CELL_SIZE-1; j++) {


            int is_snake_body = 0;
            int is_apple = 0;

            for (k = 0; k < score; k++) {								// snake 몸 그리기 , score ; 길이
                if (snake.body[k].x == j && snake.body[k].y == i) {
                	Lcd_Draw_IMG(j*CELL_SIZE, i*CELL_SIZE,  20,  20,  &snake_head_img);
                    is_snake_body = 1;
                }
            }

            if (!is_snake_body && food.x == j && food.y == i) {				// 사과 그리기
            	Lcd_Draw_IMG(j*CELL_SIZE, i*CELL_SIZE,  20,  20,  &apple_img);
            	is_apple = 1;

            }

            if(is_apple ==0 && is_snake_body ==0)
            	Lcd_Draw_IMG(j*CELL_SIZE, i*CELL_SIZE,  20,  20,  &grass_img);
        }

    }

*/

}

// 사용자 입력 처리
void input() {
	dir = UP;
	/*
    if (_kbhit()) {
        switch (_getch()) {
            case 'a':
                dir = LEFT;
                break;
            case 'd':
                dir = RIGHT;
                break;
            case 'w':
                dir = UP;
                break;
            case 's':
                dir = DOWN;
                break;
            case 'x':
                game_over = 1;
                break;
        }
    }*/
}

// 게임 로직 처리
void logic() {

    // 뱀의 몸 길이 조정
	int i=score;
	int p=1;

	snake.tail_x = snake.body[score].x;		// 이전 그림 꼬리 save
	snake.tail_y = snake.body[score].y;

    for (i = score+1; i > 0; i--) {
    	snake.body[i].x = snake.body[i - 1].x;
    	snake.body[i].y = snake.body[i - 1].y;
    }

    // 뱀의 머리 이동
    switch (dir) {
        case LEFT:
        	snake.body[0].x--;
            break;
        case RIGHT:
        	snake.body[0].x++;
            break;
        case UP:
        	snake.body[0].y--;
            break;
        case DOWN:
        	snake.body[0].y++;
            break;
    }

    // 벽 충돌 체크
    if (snake.body[0].x >= WIDTH / CELL_SIZE -1 || snake.body[0].x < 1 || snake.body[0].y >= HEIGHT / CELL_SIZE -1 || snake.body[0].y < 1)
        game_over = 1;

    // 뱀이 자신과 충돌하는지 체크
    for (p = 1; p < score; p++) {
        if (snake.body[0].x == snake.body[p].x && snake.body[0].y == snake.body[p].y)
            game_over = 1;
    }

    // 먹이 먹었는지 체크
    if (snake.body[0].x == food.x && snake.body[0].y == food.y) {
    	eaten = 1;
        score++;
        food.x = rand() % ((WIDTH -2*CELL_SIZE)/ CELL_SIZE) +1;	//(1 ~11)
        food.y = rand() % ((HEIGHT -2*CELL_SIZE) / CELL_SIZE) +1;  //(1 ~11)
    }
    else
    {
    	eaten = 0;

    }



}

// 메인 함수
int snake_game() {
    setup();
    draw_init();
    volatile long long int i;
    while (!game_over) {

    	draw();
        input();
        logic();

        for(i=0 ; i<3000000; i++)
        {
        	;
        }
//        // 게임 속도 조절
//        _sleep(100); // Windows에서 0.1초 지연
//        // usleep(100000); // Linux/macOS에서 사용할 경우
    }
//    printf("Game Over!\n");
    return 0;
}

void rotate_image_array(unsigned short* image_array, int direction) {
    unsigned short temp[CELL_SIZE*CELL_SIZE]; // 회전된 이미지를 임시로 저장할 배열
    int i, j;

    // direction 값에 따라 회전 방향을 결정
    switch (direction) {
        case 3: // direction = 0일 때 (원래 방향, 위쪽)
            for (i = 0; i < CELL_SIZE; i++) {
                for (j = 0; j < CELL_SIZE; j++) {
                    temp[i*CELL_SIZE+j] = image_array[i*CELL_SIZE+j];
                }
            }
            break;
        case 1: // direction = 1일 때 (시계 방향으로 90도 회전, 오른쪽)
            for (i = 0; i < CELL_SIZE; i++) {
                for (j = 0; j < CELL_SIZE; j++) {
                    temp[CELL_SIZE*j+CELL_SIZE - 1 - i] = image_array[CELL_SIZE*i+CELL_SIZE+j];
                }
            }
            break;
        case 4: // direction = 2일 때 (180도 회전, 아래쪽)
            for (i = 0; i < CELL_SIZE; i++) {
                for (j = 0; j < CELL_SIZE; j++) {
                    temp[(CELL_SIZE - 1 - i)*CELL_SIZE + CELL_SIZE - 1 - j] = image_array[i*CELL_SIZE+j];
                }
            }
            break;
        case 2: // direction = 3일 때 (반시계 방향으로 90도 회전, 왼쪽)
            for (i = 0; i < CELL_SIZE; i++) {
                for (j = 0; j < CELL_SIZE; j++) {
                    temp[(CELL_SIZE - 1 - j)*CELL_SIZE+i] = image_array[i*CELL_SIZE+j];
                }
            }
            break;
        default: // 그 외의 경우
//            printf("잘못된 방향입니다.\n");
            return;
    }

    // 회전된 이미지를 원본 이미지 배열에 복사
    for (i = 0; i < CELL_SIZE; i++) {
        for (j = 0; j < CELL_SIZE; j++) {
        	image_array[i*CELL_SIZE+j] = temp[i*CELL_SIZE+j];
        }
    }
}


void Lcd_Draw_IMG(int xs,  int ys,  int w,  int h,  unsigned short *img)
{
	unsigned int i;
	int xe, ye;
	xe = xs+w-1;
	ye = ys+h-1;
	if(xe >= 320) xe=319;
	if(ye >= 240) xe=239;

	Lcd_Set_Windows(xs,  ys,  xe,  ye);

	Lcd_CS_EN();
	Lcd_RS_REG();

	for(i=0; i < (xe - xs + 1) * (ye - ys + 1); i++)
	{
		_SPI1_Write_Byte(*img >> 8);
		_SPI1_Write_Byte(*img & 0xFF);
		img++;
	}

	Lcd_CS_DIS();
}
